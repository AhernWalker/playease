playease=function(){if(playease.api)return playease.api.getInstance.apply(this,arguments)};playease.version="1.0.11";
(function(d){var f=d.utils={};f.exists=function(a){switch(f.typeOf(a)){case "string":return 0<a.length;case "object":return null!==a;case "null":return!1}return!0};f.extend=function(){var a=Array.prototype.slice.call(arguments,0),h=a[0];if(1<a.length)for(var b=1;b<a.length;b++)f.foreach(a[b],function(a,c){void 0!==c&&null!==c&&(h[a]=c)});return h};f.foreach=function(a,h){for(var b in a)a.hasOwnProperty&&"function"===f.typeOf(a.hasOwnProperty)?a.hasOwnProperty(b)&&h(b,a[b]):h(b,a[b])};f.getCookie=
function(a){var h;return(h=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)")))?unescape(h[2]):null};f.formatTime=function(a){var h=a.getHours()+1,b=a.getMinutes(),g=a.getSeconds();return a.toLocaleDateString()+" "+f.pad(h,2)+":"+f.pad(b,2)+":"+f.pad(g,2)};f.pad=function(a,h){for(a+="";a.length<h;)a="0"+a;return a};f.createElement=function(a,h){a=document.createElement(a);h&&(a.className=h);return a};f.addClass=function(a,h){var b="string"===f.typeOf(a.className)?a.className.split(" "):[];
h="array"===f.typeOf(h)?h:h.split(" ");f.foreach(h,function(a,c){-1===f.indexOf(b,c)&&b.push(c)});a.className=f.trim(b.join(" "))};f.removeClass=function(a,h){var b="string"===f.typeOf(a.className)?a.className.split(" "):[];h="array"===f.typeOf(h)?h:h.split(" ");f.foreach(h,function(a,c){a=f.indexOf(b,c);0<=a&&b.splice(a,1)});a.className=f.trim(b.join(" "))};f.emptyElement=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)};f.typeOf=function(a){if(null===a||void 0===a)return"null";var h=typeof a;
if("object"===h)try{if("[object Array]"===toString.call(a))return"array"}catch(b){}return h};f.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};f.indexOf=function(a,h){if(null==a)return-1;for(var b=0;b<a.length;b++)if(a[b]===h)return b;return-1};f.isMSIE=function(a){return a?(a=parseFloat(a).toFixed(1),a=new RegExp("msie\\s*"+a,"i"),null!==navigator.userAgent.toLowerCase().match(a)):null!==navigator.userAgent.toLowerCase().match(/msie/i)};var a=window.console=window.console||{log:function(){}};
f.log=function(){var d=Array.prototype.slice.call(arguments,0);"object"===f.typeOf(a.log)?a.log(d):a.log.apply(a,d)}})(playease);(function(d){d=d.utils;d.littleEndian=function(){var f=new ArrayBuffer(2);(new DataView(f)).setInt16(0,256,!0);return 256===(new Int16Array(f))[0]}();d.getUint32=function(f,a,d){void 0==a&&(a=0);return d?f[a+0]|f[a+1]>>>8|f[a+2]>>>16|f[a+3]>>>24:f[a+0]<<24|f[a+1]<<16|f[a+2]<<8|f[a+3]}})(playease);
(function(d){function f(){var a=document.createElement("style");a.type="text/css";document.getElementsByTagName("head")[0].appendChild(a);return a.sheet||a.styleSheet}var a=d.utils,q;(a.css=function(h,b){q||(q=f());var g="";a.foreach(b,function(a,e){g+=a+": "+e+"; "});try{q.insertRule?q.insertRule(h+" { "+g+"}",q.cssRules.length):q.addRule(h,g,q.rules.length)}catch(c){a.log("Failed to insert css rule: "+h)}}).style=function(h,b,g){if(void 0!==h&&null!==h)for(void 0===h.length&&(h=[h]),b=a.extend({},
b),g=0;g<h.length;g++){var c=h[g];void 0!==c&&null!==c&&a.foreach(b,function(a,b){a=a.split("-");for(var g=1;g<a.length;g++)a[g]=a[g].charAt(0).toUpperCase()+a[g].slice(1);a=a.join("");c.style[a]!==b&&(c.style[a]=b)})}}})(playease);
(function(d){d.events={ERROR:"error",PLAYEASE_READY:"playeaseReady",PLAYEASE_SETUP_ERROR:"playeaseSetupError",PLAYEASE_RENDER_ERROR:"playeaseRenderError",PLAYEASE_STATE:"playeaseState",CHATEASE_PROPERTY:"chateaseProperty",PLAYEASE_METADATA:"playeaseMetaData",PLAYEASE_BUFFER:"playeaseBuffer",PLAYEASE_PLAY:"playeasePlay",PLAYEASE_PAUSE:"playeasePause",PLAYEASE_SEEK:"playeaseSeek",PLAYEASE_STOP:"playeaseStop",PLAYEASE_VIEW_PLAY:"playeaseViewPlay",PLAYEASE_VIEW_PAUSE:"playeaseViewPause",PLAYEASE_VIEW_SEEK:"playeaseViewSeek",
PLAYEASE_VIEW_STOP:"playeaseViewStop",PLAYEASE_VIEW_VOLUME:"playeaseViewVolume",PLAYEASE_VIEW_MUTE:"playeaseViewMute",PLAYEASE_VIEW_FULLSCREEN:"playeaseViewFullscreen",PLAYEASE_CONTENT_LENGTH:"playeaseContentLength",PLAYEASE_PROGRESS:"playeaseProgress",PLAYEASE_COMPLETE:"playeaseComplete",PLAYEASE_FLV_TAG:"playeaseFlvTag",PLAYEASE_AVC_CONFIG_RECORD:"playeaseAVCConfigRecord",PLAYEASE_AVC_SAMPLE:"playeaseAVCSample",PLAYEASE_AAC_SPECIFIC_CONFIG:"playeaseAACSpecificConfig",PLAYEASE_AAC_SAMPLE:"playeaseAACSample",
PLAYEASE_MP4_INIT_SEGMENT:"playeaseMp4InitSegment",PLAYEASE_MP4_SEGMENT:"playeaseMp4Segment",PLAYEASE_END_OF_STREAM:"playeaseEndOfStream"}})(playease);
(function(d){var f=d.utils;d.events.eventdispatcher=function(a){function q(a,c,b){if(a)for(var g=0;g<a.length;g++){var e=a[g];if(e){null!==e.count&&0===--e.count&&delete a[g];try{e.listener(c)}catch(B){f.log('Error handling "'+b+'" event listener ['+g+"]: "+B.toString(),e.listener,c)}}}}var h={},b=[];this.addEventListener=function(a,c,b){try{f.exists(h[a])||(h[a]=[]),"string"===f.typeOf(c)&&(c=(new Function("return "+c))()),h[a].push({listener:c,count:b||null})}catch(m){f.log("error",m)}return!1};
this.removeEventListener=function(a,c){if(h[a]){try{if(void 0===c){h[a]=[];return}var b;for(b=0;b<h[a].length;b++)if(h[a][b].listener.toString()===c.toString()){h[a].splice(b,1);break}}catch(m){f.log("error",m)}return!1}};this.addGlobalListener=function(a,c){try{"string"===f.typeOf(a)&&(a=(new Function("return "+a))()),b.push({listener:a,count:c||null})}catch(e){f.log("error",e)}return!1};this.removeGlobalListener=function(a){if(a){try{var c;for(c=b.length-1;0<=c;c--)b[c].listener.toString()===a.toString()&&
b.splice(c,1)}catch(e){f.log("error",e)}return!1}};this.dispatchEvent=function(g,c){c||(c={});f.extend(c,{id:a,version:d.version,type:g});d.debug&&f.log(g,c);q(h[g],c,g);q(b,c,g)}}})(playease);
(function(d){var f=d.utils,a=d.events;f.loader=function(d){var h=f.extend(this,new a.eventdispatcher("utils.loader")),b={method:"GET",headers:{},mode:"cors",cache:"default"},g,c;h.load=function(b){g=b;c=!1;fetch?fetch(g,h.config).then(function(b){if(c)c=!1;else{if(b.ok&&200<=b.status&&299>=b.status){var e=b.headers.get("Content-Length");e&&(e=parseInt(e),h.dispatchEvent(a.PLAYEASE_CONTENT_LENGTH,{length:e}));return h.pump(b.body.getReader())}h.dispatchEvent(a.ERROR,{message:"Loader error: Invalid http status("+
b.status+" "+b.statusText+")."})}}).catch(function(c){h.dispatchEvent(a.ERROR,{message:"Loader error: "+c.message})}):h.dispatchEvent(a.ERROR,{message:"Loader error: Fetch is not supported."})};h.pump=function(b){return b.read().then(function(e){if(e.done)h.dispatchEvent(a.PLAYEASE_COMPLETE);else{if(c)return c=!1,b.cancel();h.dispatchEvent(a.PLAYEASE_PROGRESS,{data:e.value.buffer});return h.pump(b)}}).catch(function(c){h.dispatchEvent(a.ERROR,{message:"Loader error: Failed to read response data."})})};
h.abort=function(){c=!0};(function(){h.config=f.extend({},b,d);var a=new Headers,g;for(g in h.config.headers)a.append(g,h.config.headers[g]);h.config.headers=a;c=!1})()}})(playease);
(function(d){var f=d.utils,a=d.events,q={},h={onError:a.ERROR,onReady:a.PLAYEASE_READY,onMetaData:a.PLAYEASE_METADATA,onBuffer:a.PLAYEASE_BUFFER,onPlay:a.PLAYEASE_PLAY,onPause:a.PLAYEASE_PAUSE,onSeek:a.PLAYEASE_SEEK,onStop:a.PLAYEASE_STOP,onVolume:a.PLAYEASE_VIEW_VOLUME,onMute:a.PLAYEASE_VIEW_MUTE,onFullscreen:a.PLAYEASE_VIEW_FULLSCREEN};d.api=function(b){function g(a){c.dispatchEvent(a.type,a)}var c=f.extend(this,new a.eventdispatcher("api")),e;c.container=b;c.id=b.id;c.setup=function(a){f.emptyElement(c.container);
d.debug=!!a.debug;c.config=a;c.config.id=c.id;c.embedder=new d.embed(c);c.embedder.addGlobalListener(g);c.embedder.embed();return c};c.setEntity=function(a,b){e=a;c.renderName=b;c.play=e.play;c.pause=e.pause;c.seek=e.seek;c.stop=e.stop;c.volume=e.volume;c.mute=e.mute;c.fullscreen=e.fullscreen;c.resize=e.resize};(function(){f.foreach(h,function(a,b){c[a]=function(a){c.addEventListener(b,a)}})})()};d.api.getInstance=function(a){var b;null==a?a=0:a.nodeType?b=a:"string"===f.typeOf(a)&&(b=document.getElementById(a));
if(b){var c=q[b.id];c||(q[a]=c=new d.api(b));return c}return"number"===f.typeOf(a)?q[a]:null};d.api.displayError=function(a,g){}})(playease);(function(d){d.muxer={}})(playease);
(function(d){var f=d.utils,a=d.muxer.AMF={},q=a.types={DOUBLE:0,BOOLEAN:1,STRING:2,OBJECT:3,MOVIE_CLIP:4,NULL:5,UNDEFINED:6,REFERENCE:7,MIXED_ARRAY:8,END_OF_OBJECT:9,ARRAY:10,DATE:11,LONG_STRING:12,UNSUPPORTED:13,RECORD_SET:14,XML:15,TYPED_OBJECT:16,AMF3_DATA:17};a.parse=function(h,b,g){var c={};try{var e=a.parseValue(h,b,g),d=a.parseValue(h,b+e.size,g-e.size);c.key=e.data;c.value=d.data}catch(l){f.log("AMF.parse() failed. Error: "+l)}return c};a.parseObject=function(h,b,g){if(3>g)throw"Data not enough while parsing AMF object.";
for(var c={},e=0,f,d={ended:!1};!d.ended&&e<g;)f=a.parseString(h,b+e,g-e),e+=f.size,d=a.parseValue(h,b+e,g-e),e+=d.size,f.data&&d.data&&(c[f.data]=d.data);return{data:c,size:e,ended:d.ended}};a.parseString=function(a,b,g){if(2>g)throw"Data not enough while parsing AMF string.";var c=0;g=(new DataView(a,b,g)).getUint16(c);c+=2;return{data:0<g?String.fromCharCode.apply(String,new Uint8Array(a,b+c,g)):"",size:c+g}};a.parseLongString=function(a,b,g){if(4>g)throw"Data not enough while parsing AMF long string.";
var c=0;g=(new DataView(a,b,g)).getUint32(c);c+=4;return{data:0<g?String.fromCharCode.apply(String,new Uint8Array(a,b+c,g)):"",size:c+g}};a.parseDate=function(a,b,g){if(10>g)throw"Data not enough while parsing AMF date.";g=new DataView(a,b,g);a=0;b=g.getFloat64(a);a+=8;g=g.getInt16(a);return{data:new Date(b+6E4*g),size:a+2}};a.parseValue=function(d,b,g){if(1>g)throw"Data not enough while parsing AMF value.";var c=new DataView(d,b,g),e=0,h=c.getUint8(e),e=e+1,l=void 0,B=!1;try{switch(h){case q.DOUBLE:l=
c.getFloat64(e);e+=8;break;case q.BOOLEAN:l=c.getUint8(e)?!0:!1;e+=1;break;case q.STRING:var v=a.parseString(d,b+e,g-e),l=v.data,e=e+v.size;break;case q.OBJECT:var x=a.parseObject(d,b+e,g-e),l=x.data,e=e+x.size;break;case q.MIXED_ARRAY:var E;c.getUint32(e);var e=e+4,G=a.parseObject(d,b+e,g-e),l=G.data,e=e+G.size;break;case q.END_OF_OBJECT:l=void 0;B=!0;break;case q.ARRAY:E=c.getUint32(e);e+=4;l=[];for(c=0;c<E;c++){var F=a.parseValue(d,b+e,g-e);l.push(F.data);e+=F.size}break;case q.DATE:var k=a.parseDate(d,
b+e,g-e),l=k.data,e=e+k.size;break;case q.LONG_STRING:var n=a.parseString(d,b+e,g-e),l=n.data,e=e+n.size;break;default:f.log("Skipping unsupported AMF value type("+h+")."),e+=g}}catch(t){f.log("AMF.parseValue() failed. Error: "+t)}return{data:l,size:e,ended:B}}})(playease);
(function(d){var f=function(a){function d(){var a=e-c;if(0>=a)throw"Data not enough while filling current word.";var a=Math.min(4,a),b=new Uint8Array(4);b.set(g.subarray(c,c+a));m=(new DataView(b.buffer)).getUint32(0,!1);c+=a;l=8*a}function f(){var a;for(a=0;a<l;a++)if(0!==(m&2147483648>>>a))return m<<=a,l-=a,a;d();return a+f()}var b=this,g,c,e,m,l;b.readBits=function(a){if(32<a)throw"Data not enough while reading bits of ExpGolomb.";if(a<=l){var c=m>>>32-a;m<<=a;l-=a;return c}c=l?m:0;c>>>=32-l;a-=
l;d();a=Math.min(a,l);var b=m>>>32-a;m<<=a;l-=a;return c<<a|b};b.readBool=function(){return 1===b.readBits(1)};b.readByte=function(){return b.readBits(8)};b.readUEG=function(){var a=f();return b.readBits(a+1)-1};b.readSEG=function(){var a=b.readUEG();return a&1?a+1>>>1:-1*(a>>>1)};b.destroy=function(){g=null};g=a;c=0;e=a.byteLength;l=m=0};(d.muxer.SPS={}).parse=function(a){for(var d=a.byteLength,h=new Uint8Array(d),b=0,g=0;g<d;g++)2<=g&&3===a[g]&&0===a[g-1]&&0===a[g-2]||(h[b]=a[g],b++);a=new Uint8Array(h.buffer,
0,b);a=new f(a);a.readByte();var c=a.readByte();a.readByte();h=a.readByte();a.readUEG();switch(c){case 66:d="Baseline";break;case 77:d="Main";break;case 88:d="Extended";break;case 100:d="High";break;case 110:d="High10";break;case 122:d="High422";break;case 244:d="High444";break;default:d="Unknown"}var h=(h/10).toFixed(1),e=1,b=420,m=[0,420,422,444],g=8;if(100===c||110===c||122===c||244===c||44===c||83===c||86===c||118===c||128===c||138===c||144===c)if(e=a.readUEG(),3===e&&a.readBits(1),3>=e&&(b=m[e]),
g=a.readUEG()+8,a.readUEG(),a.readBits(1),a.readBool())for(c=3!==e?8:12,m=0;m<c;m++)if(a.readBool())for(var l=a,B=6>m?16:64,v=8,x=8,E=0;E<B;E++)0!==x&&(x=l.readSEG(),x=(v+x+256)%256),v=0===x?v:x;a.readUEG();c=a.readUEG();if(0===c)a.readUEG();else if(1===c)for(a.readBits(1),a.readSEG(),a.readSEG(),c=a.readUEG(),m=0;m<c;m++)a.readSEG();a.readUEG();a.readBits(1);var G=a.readUEG(),x=a.readUEG(),F=a.readBits(1);0===F&&a.readBits(1);a.readBits(1);var k=0,n=0,t=0,A=0;a.readBool()&&(k=a.readUEG(),n=a.readUEG(),
t=a.readUEG(),A=a.readUEG());m=c=1;v=0;l=!0;E=B=0;if(a.readBool()){if(a.readBool()){var r=a.readByte(),y=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],w=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];0<r&&16>r?(c=y[r-1],m=w[r-1]):255===r&&(c=a.readByte()<<8|a.readByte(),m=a.readByte()<<8|a.readByte())}a.readBool()&&a.readBool();a.readBool()&&(a.readBits(4),a.readBool()&&a.readBits(24));a.readBool()&&(a.readUEG(),a.readUEG());a.readBool()&&(v=a.readBits(32),B=a.readBits(32),l=a.readBool(),E=2*v,v=
B/E)}r=1;if(1!==c||1!==m)r=c/m;0===e?(y=1,e=2-F):(y=3===e?1:2,e=(1===e?2:1)*(2-F));G=16*(G+1)-(k+n)*y;e=16*(2-F)*(x+1)-(t+A)*e;x=Math.ceil(G*r);a.destroy();switch(b){case 420:a="4:2:0";break;case 422:a="4:2:2";break;case 444:a="4:4:4";break;default:a="Unknown"}return{profile_string:d,level_string:h,bit_depth:g,chroma_format:b,chroma_format_string:a,frame_rate:{fixed:l,fps:v,fps_den:E,fps_num:B},sar_ratio:{width:c,height:m},codec_size:{width:G,height:e},present_size:{width:x,height:e}}}})(playease);
(function(d){var f=d.utils,a=d.events;d=d.muxer;var q=d.SPS,h={AUDIO:8,VIDEO:9,SCRIPT:18},b={KEYFRAME:1,INTER_FRAME:2,DISPOSABLE_INTER_FRAME:3,GENERATED_KEYFRAME:4,INFO_OR_COMMAND_FRAME:5},g={types:{SEQUENCE_HEADER:0,NALU:1,END_OF_SEQUENCE:2}},c={types:{SPECIFIC_CONFIG:0,RAW_FRAME_DATA:1},audioObjectTypes:{NULL:0,AAC_MAIN:1,AAC_LC:2,AAC_SSR:3,AAC_LTP:4,AAC_HE_OR_SBR:5,AAC_SCALABLE:6},samplingRates:[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350]},e=[5500,11025,22050,44100,48E3],
m=function(){var a=this;a.isComplete=function(){var c=!1===a.hasAudio||!0===a.hasAudio&&null!=a.audioCodec&&null!=a.audioSampleRate&&null!=a.audioChannelCount,b=!1===a.hasVideo||!0===a.hasVideo&&null!=a.videoCodec&&null!=a.width&&null!=a.height&&null!=a.fps&&null!=a.profile&&null!=a.level&&null!=a.chromaFormat&&null!=a.sarNum&&null!=a.sarDen;return null!=a.mimeType&&null!=a.duration&&null!=a.metadata&&null!=a.hasKeyframesIndex&&c&&b};a.isSeekable=function(){return!0===a.hasKeyframesIndex};a.getNearestKeyframe=
function(c){if(null==a.keyframesIndex)return null;var b=a.keyframesIndex,d=b.times,e=0,g=d.length-1,f,h=0,m=g;c<d[0]&&(e=0,h=m+1);for(;h<=m;)if(f=h+Math.floor((m-h)/2),f===g||c>=d[f]&&c<d[f+1]){e=f;break}else d[f]<c?h=f+1:m=f-1;c=e;return{index:c,milliseconds:b.times[c],fileposition:b.filepositions[c]}}};d.flv=function(d){var l=f.extend(this,new a.eventdispatcher("muxer.flv")),v,x,E,G,F,k,n,t,A,r,y,w,z,J,D,u,p,I;l.reset=function(){x=v=0;E=1;k.position=0;y=[];w=new m;D={type:"video",id:1,sequenceNumber:0,
samples:[],length:0};u={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};I=p=0};l.parse=function(c){var p=new Uint8Array(c),b=0;if(1==E){if(13>c.byteLength)return 0;b=l.probe(c);E=4;var d=f.getUint32(p,b);d&&f.log("First tag size "+d);b+=4;E=2}for(;b<c.byteLength;)switch(E){case 2:t[k.position++]=p[b++];11==k.position&&(r=t[1]<<16|t[2]<<8|t[3],E=3);break;case 3:var g=t[0],C=t[1]<<16|t[2]<<8|t[3],I=t[4]<<16|t[5]<<8|t[6]|t[7]<<24,d=t[8]<<16|t[9]<<8|t[10];0!=d&&f.log("Unknown stream ID "+d);d=
{tag:g,data:c,offset:b,size:C};switch(g){case h.AUDIO:d.timestamp=I;r==C&&(d.format=p[b]>>>4,d.rate=e[(p[b]&12)>>>2],d.samplesize=(p[b]&2)>>>1,d.sampletype=p[b]&1);break;case h.VIDEO:d.timestamp=I;r==C&&(d.frametype=p[b]>>>4,d.codec=p[b]&15);break;case h.SCRIPT:d.hasAudio=G,d.hasVideo=F}g=Math.min(c.byteLength-b,r);r-=g;b+=g;if(r){y.push(d);break}if(y.length){d=y[0];C=new Uint8Array(C);for(C.position=0;y.length;)I=y.shift(),g=new Uint8Array(I.data.slice(I.offset)),C.set(g,C.position),C.position+=
I.data.byteLength-I.offset;g=new Uint8Array(c.slice(0,b));C.set(g,C.position);d.data=C.buffer;d.offset=0}E=4;n.position=0;l.dispatchEvent(a.PLAYEASE_FLV_TAG,d);break;case 4:A[n.position++]=p[b++];4==n.position&&(C=t[1]<<16|t[2]<<8|t[3],d=f.getUint32(A),d!=11+C&&f.log("prevTagSize("+d+") is not equals to "+(11+C)+"."),E=2,k.position=0);break;default:f.log("Unknown parsing state "+E);return}};l.parseAVCVideoPacket=function(c,d,e,h,k){if(5>e)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AVC video packet."});
else{var C=new DataView(c,d,e),t=1,m=C.getUint8(t++),C=C.getUint8(t++)<<16|C.getUint8(t++)<<8|C.getUint8(t++);switch(m){case g.types.SEQUENCE_HEADER:C=d+t;d=e-t;if(7>d)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AVC decoder configuration record."});else if(e=D,e={type:e.type,id:e.id,timescale:1E3,duration:1E3*z.duration||0},t=new DataView(c,C,d),m=0,k=t.getUint8(m++),h=t.getUint8(m++),t.getUint8(m++),t.getUint8(m++),1!=k||0==h)l.dispatchEvent(a.ERROR,{message:"Invalid AVCDecoderConfigurationRecord."});
else if(p=1+(t.getUint8(m++)&3),3!=p&&4!=p)l.dispatchEvent(a.ERROR,{message:"Invalid lengthSizeMinusOne "+p+"."});else{h=t.getUint8(m++)&31;for(k=0;k<h;k++){var n=t.getUint16(m),m=m+2;if(0!=n){var K=new Uint8Array(c,C+m,n),m=m+n,n=q.parse(K),r=e,H=n;r.codecWidth=H.codec_size.width;r.codecHeight=H.codec_size.height;r.presentWidth=H.present_size.width;r.presentHeight=H.present_size.height;r.profile=H.profile_string;r.level=H.level_string;r.bitDepth=H.bit_depth;r.chromaFormat=H.chroma_format;r.sarRatio=
H.sar_ratio;r.frameRate=H.frame_rate;if(!1===H.frame_rate.fixed||0===H.frame_rate.fps_num||0===H.frame_rate.fps_den)r.frameRate=J;r.refSampleDuration=Math.floor(r.frameRate.fps_den/r.frameRate.fps_num*r.timescale);for(var K=K.subarray(1,4),H="avc1.",L=0;3>L;L++){var M=K[L].toString(16);2>M.length&&(M="0"+M);H+=M}r.codec=H;r=e;w.hasAudio=G;w.hasVideo=F;w.duration=1E3*z.duration;w.metadata=z;w.width=r.codecWidth;w.height=r.codecHeight;w.fps=r.frameRate.fps;w.profile=r.profile;w.level=r.level;w.chromaFormat=
n.chroma_format_string;w.sarNum=r.sarRatio.width;w.sarDen=r.sarRatio.height;w.videoCodec=r.codec;w.mimeType='video/mp4; codecs="'+w.videoCodec+(w.hasAudio&&w.audioCodec?","+w.audioCodec:"")+'"';l.dispatchEvent(a.PLAYEASE_MEDIA_INFO,{info:w})}}h=t.getUint8(m++);for(k=0;k<h;k++)n=t.getUint16(m),m+=2,0!=n&&(new Uint8Array(c,C+m,n),m+=n);e.avcc=new Uint8Array(d);e.avcc.set(new Uint8Array(c,C,d),0);l.dispatchEvent(a.PLAYEASE_AVC_CONFIG_RECORD,{data:e})}break;case g.types.NALU:a:{d+=t;e-=t;t=new DataView(c,
d,e);m=[];h=I+h;k=k==b.KEYFRAME;for(r=n=0;n<e;){if(n+4>=e){l.dispatchEvent(a.ERROR,{message:"Data not enough for next NALU."});break a}K=t.getUint32(n);3==K&&(K>>>=8);if(K>e-p){f.log("Malformed Nalus near timestamp "+h+".");break a}H=t.getUint8(n+p)&31;H==b.INFO_OR_COMMAND_FRAME&&(k=!0);L=new Uint8Array(c,d+n,p+K);r+=L.byteLength;m.push({type:H,data:L});n+=p+K}0!=m.length&&(D.samples.push({units:m,length:r,isKeyframe:k,cts:C,dts:h,pts:C+h}),D.length+=r,l.dispatchEvent(a.PLAYEASE_AVC_SAMPLE,{data:D}))}break;
case g.types.END_OF_SEQUENCE:l.dispatchEvent(a.PLAYEASE_END_OF_STREAM);break;default:l.dispatchEvent(a.ERROR,{message:"Unknown AVC video packet type "+m+"."})}}};l.parseAACAudioPacket=function(p,b,d,e,g,f,h){if(2>d)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio packet."});else switch(g=1,f=(new DataView(p,b,d)).getUint8(g++),f){case c.types.SPECIFIC_CONFIG:a:if(e=b+g,d-=g,2>d)l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC audio specific config."});else if(f=
new DataView(p,e,d),h=0,e=f.getUint8(h)>>>3,p=(f.getUint8(h++)&7)<<1|f.getUint8(h)>>>7,0>p||p>=c.samplingRates.length)l.dispatchEvent(a.ERROR,{message:"Invalid AAC sampling frequency index.",index:p});else if(b=u,b={type:b.type,id:b.id,timescale:1E3,duration:1E3*z.duration||0},b.audioSampleRate=c.samplingRates[p],b.refSampleDuration=Math.floor(1024/b.audioSampleRate*b.timescale),g=(f.getUint8(h)&120)>>>3,0>g||8<=g)l.dispatchEvent(a.ERROR,{message:"Invalid AAC channel configuration.",config:g});else{if(e===
c.audioObjectTypes.AAC_HE_OR_SBR){if(3>d){l.dispatchEvent(a.ERROR,{message:"Data not enough while parsing AAC_HE_OR_SBR audio specific config."});break a}f.getUint8(h++);f.getUint8(h);f.getUint8(h)}d=self.navigator.userAgent.toLowerCase();-1!==d.indexOf("firefox")?p>=c.audioObjectTypes.AAC_SCALABLE?(e=c.audioObjectTypes.AAC_HE_OR_SBR,d=p-3,f=Array(4)):(e=c.audioObjectTypes.AAC_LC,d=p,f=Array(2)):-1!==d.indexOf("android")?(e=c.audioObjectTypes.AAC_LC,d=p,f=Array(2)):(e=c.audioObjectTypes.AAC_HE_OR_SBR,
d=p,f=Array(4),p>=c.audioObjectTypes.AAC_SCALABLE?d=p-3:1===g&&(e=c.audioObjectTypes.AAC_LC,d=p,f=Array(2)));f[0]=e<<3;f[0]|=(p&15)>>>1;f[1]=(p&15)<<7;f[1]|=(g&15)<<3;e===c.audioObjectTypes.AAC_HE_OR_SBR&&(f[1]|=(d&15)>>>1,f[2]=(d&1)<<7,f[2]|=8,f[3]=0);b.channelCount=g;b.codec="mp4a.40."+e;b.config=f;w.audioCodec=b.codec;w.audioSampleRate=b.audioSampleRate;w.audioChannelCount=b.channelCount;w.mimeType='video/mp4; codecs="'+w.videoCodec+(w.hasAudio&&w.audioCodec?","+w.audioCodec:"")+'"';l.dispatchEvent(a.PLAYEASE_MEDIA_INFO,
{info:w});l.dispatchEvent(a.PLAYEASE_AAC_SPECIFIC_CONFIG,{data:b})}break;case c.types.RAW_FRAME_DATA:p=new Uint8Array(p,b+g,d-g);d=I+e;u.samples.push({unit:p,dts:d,pts:d});u.length+=p.length;l.dispatchEvent(a.PLAYEASE_AAC_SAMPLE,{data:u});break;default:l.dispatchEvent(a.ERROR,{message:"Unknown AAC audio packet type "+f+"."})}};l.probe=function(a){a=new Uint8Array(a);if(70!==a[0]||76!==a[1]||86!==a[2]||1!==a[3])return 0;G=0!==(a[4]&4)>>>2;F=0!==(a[4]&1);if(!G&&!F)return 0;a=f.getUint32(a,5);return 9>
a?0:a};l.setMetaData=function(a){z=a;"number"===typeof z.audiodatarate&&(w.audioDataRate=z.audiodatarate);"number"===typeof z.videodatarate&&(w.videoDataRate=z.videodatarate);if("number"===typeof z.framerate&&(a=Math.floor(1E3*z.framerate),0<a)){var p=a/1E3;J.fixed=!0;J.fps=p;J.fps_num=a;J.fps_den=1E3;w.fps=p}w.hasKeyframesIndex="object"===typeof z.keyframes?!0:!1};l.getMetaData=function(){return z};l.offset=function(){return v};l.length=function(){return x};l.destroy=function(){};l.config=f.extend({},
{},d);x=v=0;E=1;k=new ArrayBuffer(11);k.position=0;t=new Uint8Array(k);n=new ArrayBuffer(4);n.position=0;A=new Uint8Array(n);r=0;y=[];w=new m;J={fixed:!0,fps:23.976,fps_num:23976,fps_den:1E3};D={type:"video",id:1,sequenceNumber:0,samples:[],length:0};u={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};I=p=0};d.flv.TAG=h;d.flv.FORMATS={LINEAR_PCM_PLATFORM_ENDIAN:0,ADPCM:1,MP3:2,LINEAR_PCM_LITTLE_ENDIAN:3,NELLYMOSER_16_kHz_MONO:4,NELLYMOSER_8_kHz_MONO:5,NELLYMOSER:6,G_711_A_LAW_LOGARITHMIC_PCM:7,
G_711_MU_LAW_LOGARITHMIC_PCM:8,RESERVED:9,AAC:10,SPEEX:11,MP3_8_kHz:14,DEVICE_SPECIFIC_SOUND:15};d.flv.FRAMES=b;d.flv.CODECS={JPEG:1,H263:2,SCREEN_VIDEO:3,VP6:4,VP6_ALPHA:5,SCREEN_VIDEO_2:6,AVC:7};d.flv.AVC=g;d.flv.AAC=c})(playease);
(function(d){var f=d.utils,a=d.events;d=d.muxer;var q=d.flv.AAC,h,b,g,c,e,m,l,B,v;h=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]);b=new Uint8Array([0,0,0,0,0,0,0,1]);g=new Uint8Array([0,0,0,0,0,0,0,0]);c=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);m=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,
108,101,114,0]);l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);B=new Uint8Array([0,0,0,0,0,0,0,0]);v=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);q.getSilentFrame=function(a){return 1===a?new Uint8Array([0,200,0,128,35,128]):2===a?new Uint8Array([33,0,73,144,2,25,0,35,128]):3===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]):4===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]):5===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,
0,33,144,2,56]):6===a?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]):null};var x=function(a,c,b,d,e){this.dts=a;this.pts=c;this.duration=b;this.originalDts=d;this.isSyncPoint=e;this.fileposition=null},E=function(){var a=[];this.appendSyncPoint=function(c){c.isSyncPoint=!0;a.push(c)}},G=function(a){function c(){d=[];e=-1}var b=this,d,e;b.reset=c;b.searchNearestSegmentBefore=function(a){if(0===d.length)return-2;var c=d.length-1,b,e=0,f=c,g=0;if(a<d[0].originalBeginDts)return-1;
for(;e<=f;){b=e+Math.floor((f-e)/2);if(b===c||a>d[b].lastSample.originalDts&&a<d[b+1].originalBeginDts){g=b;break}d[b].originalBeginDts<a?e=b+1:f=b-1}return g};b.searchNearestSegmentAfter=function(a){return b.searchNearestSegmentBefore(a)+1};b.append=function(a){var c=e,f=0;-1!==c&&c<d.length&&a.originalBeginDts>=d[c].lastSample.originalDts&&(c===d.length-1||c<d.length-1&&a.originalBeginDts<d[c+1].originalBeginDts)?f=c+1:0<d.length&&(f=b.searchNearestSegmentBefore(a.originalBeginDts)+1);e=f;d.splice(f,
0,a)};b.getLastSegmentBefore=function(a){a=b.searchNearestSegmentBefore(a);return 0>a?null:d[a]};b.getLastSampleBefore=function(a){a=b.getLastSegmentBefore(a);return null==a?null:a.lastSample};b.getLastSyncPointBefore=function(a){a=b.searchNearestSegmentBefore(a);for(var c=d[a].syncPoints;0===c.length&&a--;)c=d[a].syncPoints;return 0>=c.length?null:c[c.length-1]};b.isEmpty=function(){return 0===d.length};b.clear=function(){d=[];e=-1};c()};d.mp4=function(d){var k=f.extend(this,new a.eventdispatcher("muxer.mp4")),
n={islive:!1},t,A,r,y,w,z,F,D,u={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};k.reset=function(){t=0;r=A=void 0;z.reset();F.reset();D=!1};k.getInitSegment=function(c){var b=k.box(u.ftyp,h),p=k.moov(c),d=new Uint8Array(b.byteLength+p.byteLength);d.set(b,0);d.set(p,b.byteLength);
k.dispatchEvent(a.PLAYEASE_MP4_INIT_SEGMENT,{tp:c.type,data:d})};k.getVideoSegment=function(c){var b=c.samples,p=void 0,d=-1,e=-1,f;if(b&&0!==b.length){f=0;var g=8+c.length,h=new Uint8Array(g);h[f++]=g>>>24&255;h[f++]=g>>>16&255;h[f++]=g>>>8&255;h[f++]=g&255;h.set(u.mdat,f);f+=4;for(var g=[],m=new E;b.length;){var l=b.shift(),n=l.isKeyframe,q=l.dts-t;if(void 0==p)if(void 0==A)if(z.isEmpty())p=0;else if(p=z.getLastSampleBefore(q),null!=p){var r=q-(p.originalDts+p.duration);3>=r&&(r=0);p=q-(p.dts+p.duration+
r)}else p=0;else p=q-A;var r=q-p,w=l.cts,v=r+w;-1===d&&(d=r,e=v);for(var F=0;l.units.length;){var D=l.units.shift().data;h.set(D,f);f+=D.byteLength;F+=D.byteLength}D=1<=b.length?b[0].dts-t-p-r:1<=g.length?g[g.length-1].duration:y.refSampleDuration+p;if(n){var B=new x(r,v,D,l.dts,!0);B.fileposition=l.fileposition;m.appendSyncPoint(B)}g.push({dts:r,pts:v,cts:w,size:F,isKeyframe:n,duration:D,originalDts:q,flags:{isLeading:0,dependsOn:n?2:1,isDependedOn:n?1:0,hasRedundancy:0,isNonSync:n?0:1}})}l=g[g.length-
1];b=l.dts+l.duration;f=l.pts+l.duration;A=b;m.beginDts=d;m.endDts=b;m.beginPts=e;m.endPts=f;m.originalBeginDts=g[0].originalDts;m.originalEndDts=l.originalDts+l.duration;m.firstSample=new x(g[0].dts,g[0].pts,g[0].duration,g[0].originalDts,g[0].isKeyframe);m.lastSample=new x(l.dts,l.pts,l.duration,l.originalDts,l.isKeyframe);k.config.islive||z.append(m);c.samples=g;c.sequenceNumber++;d=k.moof(c,d);c.samples=[];c.length=0;k.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"video",data:_mergeBoxes(d,h),sampleCount:g.length,
info:m})}};k.getAudioSegment=function(c){var b=c.samples,p=void 0,d=-1,e;e=!1;var g=-1;if(b&&0!==b.length){var h=0,m=8+c.length,l=new Uint8Array(m);l[h++]=m>>>24&255;l[h++]=m>>>16&255;l[h++]=m>>>8&255;l[h++]=m&255;l.set(u.mdat,h);for(var h=h+4,n=[];b.length;){var v=b.shift(),y=v.unit,B=v.dts-t;if(void 0==p)if(void 0==r)if(F.isEmpty())p=0,D&&!z.isEmpty()&&(e=!0);else if(p=F.getLastSampleBefore(B),null!=p){var A=B-(p.originalDts+p.duration);3>=A&&(A=0);p=B-(p.dts+p.duration+A)}else p=0;else p=B-r;A=
B-p;if(e){var G=z.getLastSegmentBefore(B);null!=G&&G.beginDts<A?(g=A-G.beginDts,A=G.beginDts):e=!1}-1===d&&(d=A);e?(e=!1,b.unshift(v),v=A,y=g,B=q.getSilentFrame(w.channelCount),null==B?(f.log("Cannot generate silent aac frame, channelCount: "+w.channelCount+"."),v=null):v={unit:B,mp4Sample:{dts:v,pts:v,cts:0,size:B.byteLength,duration:y,originalDts:v,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}},null!=v&&(y=v.unit,n.push(v.mp4Sample),h=0,m+=y.byteLength,l=new Uint8Array(m),l[h++]=
m>>>24&255,l[h++]=m>>>16&255,l[h++]=m>>>8&255,l[h++]=m&255,l.set(u.mdat,h),h+=4,l.set(y,h),h+=y.byteLength)):(n.push({dts:A,pts:A,cts:0,size:y.byteLength,duration:1<=b.length?b[0].dts-t-p-A:1<=n.length?n[n.length-1].duration:w.refSampleDuration+p,originalDts:B,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),l.set(y,h),h+=y.byteLength)}g=n[n.length-1];r=e=g.dts+g.duration;b=new E;b.beginDts=d;b.endDts=e;b.beginPts=d;b.endPts=e;b.originalBeginDts=n[0].originalDts;b.originalEndDts=g.originalDts+
g.duration;b.firstSample=new x(n[0].dts,n[0].pts,n[0].duration,n[0].originalDts,!1);b.lastSample=new x(g.dts,g.pts,g.duration,g.originalDts,!1);k.config.islive||F.append(b);c.samples=n;c.sequenceNumber++;d=k.moof(c,d);c.samples=[];c.length=0;k.dispatchEvent(a.PLAYEASE_MP4_SEGMENT,{tp:"audio",data:_mergeBoxes(d,l),sampleCount:n.length,info:b})}};_mergeBoxes=function(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(a,0);c.set(b,a.byteLength);return c};k.setVideoMeta=function(a){y=a};k.setAudioMeta=
function(a){w=a};k.box=function(a){for(var b=8,c=Array.prototype.slice.call(arguments,1),p=0;p<c.length;p++)b+=c[p].byteLength;var d=new Uint8Array(b),e=0;d[e++]=b>>>24&255;d[e++]=b>>>16&255;d[e++]=b>>>8&255;d[e++]=b&255;d.set(a,e);e+=4;for(p=0;p<c.length;p++)d.set(c[p],e),e+=c[p].byteLength;return d};k.moov=function(a){var b=k.mvhd(a.timescale,a.duration),c=k.trak(a);a=k.mvex(a);return k.box(u.moov,b,c,a)};k.mvhd=function(a,b){return k.box(u.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,a>>>24&255,
a>>>16&255,a>>>8&255,a&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))};k.trak=function(a){return k.box(u.trak,k.tkhd(a),k.mdia(a))};k.tkhd=function(a){var b=a.id,c=a.duration,d=a.presentWidth;a=a.presentHeight;return k.box(u.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,0,0,0,0,c>>>24&255,c>>>16&
255,c>>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,d>>>8&255,d&255,0,0,a>>>8&255,a&255,0,0]))};k.mdia=function(a){return k.box(u.mdia,k.mdhd(a),k.hdlr(a),k.minf(a))};k.mdhd=function(a){var b=a.timescale;a=a.duration;return k.box(u.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255,a>>>24&255,a>>>16&255,a>>>8&255,a&255,85,196,0,0]))};k.hdlr=function(a){return k.box(u.hdlr,"audio"===a.type?m:e)};
k.minf=function(a){var b;b="audio"===a.type?k.box(u.smhd,B):k.box(u.vmhd,v);return k.box(u.minf,b,k.dinf(),k.stbl(a))};k.dinf=function(){return k.box(u.dinf,k.box(u.dref,l))};k.stbl=function(a){return k.box(u.stbl,k.stsd(a),k.box(u.stts,g),k.box(u.stsc,g),k.box(u.stsz,c),k.box(u.stco,g))};k.stsd=function(a){return"audio"===a.type?k.box(u.stsd,b,k.mp4a(a)):k.box(u.stsd,b,k.avc1(a))};k.mp4a=function(a){var b=a.audioSampleRate,b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,16,0,
0,0,0,b>>>8&255,b&255,0,0]);return k.box(u.mp4a,b,k.esds(a))};k.esds=function(a){a=a.config;var b=a.length;a=new Uint8Array([0,0,0,0,3,23+b,0,1,0,4,15+b,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([b]).concat(a).concat([6,1,2]));return k.box(u.esds,a)};k.avc1=function(a){var b=a.avcc,c=a.codecWidth;a=a.codecHeight;c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>>8&255,c&255,a>>>8&255,a&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return k.box(u.avc1,c,k.box(u.avcC,b))};k.mvex=function(a){return k.box(u.mvex,k.trex(a))};k.trex=function(a){a=a.id;a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return k.box(u.trex,a)};k.moof=function(a,b){return k.box(u.moof,k.mfhd(a.sequenceNumber),k.traf(a,b))};k.mfhd=function(a){a=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,a&255]);return k.box(u.mfhd,a)};k.traf=function(a,b){var c=a.id,c=k.box(u.tfhd,
new Uint8Array([0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,c&255]));b=k.box(u.tfdt,new Uint8Array([0,0,0,0,b>>>24&255,b>>>16&255,b>>>8&255,b&255]));var d=k.sdtp(a);a=k.trun(a,d.byteLength+16+16+8+16+8+8);return k.box(u.traf,c,b,a,d)};k.sdtp=function(a){a=a.samples||[];for(var b=a.length,c=new Uint8Array(4+b),d=0;d<b;d++){var e=a[d].flags;c[d+4]=e.isLeading<<6|e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy}return k.box(u.sdtp,c)};k.trun=function(a,b){a=a.samples||[];var c=a.length,d=12+16*c,e=new Uint8Array(d);
b+=8+d;e.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,c&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255],0);for(b=0;b<c;b++){var d=a[b].duration,g=a[b].size,f=a[b].flags,h=a[b].cts;e.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.isNonSync,0,0,h>>>24&255,h>>>16&255,h>>>8&255,h&255],12+16*b)}return k.box(u.trun,e)};k.mdat=function(a){return k.box(u.mdat,a)};k.destroy=function(){};(function(){k.config=f.extend({},
n,d);for(var a in u)u[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)];t=0;z=new G("video");F=new G("audio");D=!1})()}})(playease);(function(d){d.core={}})(playease);(function(d){d.core.states={BUFFERING:"buffering",PLAYING:"playing",SEEKING:"seeking",PAUSED:"paused",STOPPED:"stopped",ERROR:"error"}})(playease);(function(d){d.core.skins={}})(playease);(function(d){d.core.skins.modes={DEFAULT:"def"}})(playease);
(function(d){var f=d.utils,a=d.events;d=d.core.skins;var q=d.modes,h=f.css,b="pla-skin";d.def=function(d){var c=f.extend(this,new a.eventdispatcher("skins.def")),e=d.height;c.resize=function(a,b){f.log("Resizing to "+a+", "+b);parseInt(a);e=parseInt(b)};c.name=q.DEFAULT;b+="-"+c.name;h(".pla-wrapper",{width:d.width+"px",height:e+"px","box-shadow":"0 1px 1px rgba(0, 0, 0, 0.05)"});h(".pla-wrapper *",{margin:"0",padding:"0","font-family":"\u5fae\u8f6f\u96c5\u9ed1,arial,sans-serif","font-size":"14px",
"font-weight":"normal","box-sizing":"content-box"});h("."+b+" .pla-render",{width:"100%",height:"100%",position:"relative"});h("."+b+" .pla-render video",{})}})(playease);(function(d){d.core.renders={}})(playease);(function(d){d.core.renders.modes={DEFAULT:"def",FLV:"flv"}})(playease);
(function(d){var f=d.utils,a=d.events;d=d.core.renders;var q=d.modes;d.def=function(d,b){function g(b){e.removeEventListener("play",g);c.dispatchEvent(a.PLAYEASE_VIEW_PLAY)}var c=f.extend(this,new a.eventdispatcher("renders.def")),e;c.setup=function(){c.dispatchEvent(a.PLAYEASE_READY,{id:c.config.id})};c.play=function(a){a&&(b.url=a);if(a||e.src!=b.url)e.pause(),e.src=b.url,e.load();e.play()};c.pause=function(){e.pause()};c.seek=function(a){};c.stop=function(){e.pause();e.src=null};c.volume=function(a){};
c.mute=function(a){};c.fullscreen=function(a){};c.element=function(){return e};c.resize=function(a,b){};c.destroy=function(){};c.name=q.DEFAULT;c.config=f.extend({},{},b);e=f.createElement("video");e.width=c.config.width;e.height=c.config.height;e.controls=c.config.controls;e.autoplay=c.config.autoplay;e.poster=c.config.poster;c.config.autoplay||e.addEventListener("play",g)}})(playease);
(function(d){var f=d.utils,a=d.events,q=d.muxer;d=d.core.renders;var h=d.modes,b=q.AMF,g=q.flv.TAG,c=q.flv.FORMATS,e=q.flv.CODECS;d.flv=function(d,l){function m(b){t.removeEventListener("play",m);n.dispatchEvent(a.PLAYEASE_VIEW_PLAY)}function v(a){f.log("media source open");A.load(l.url)}function x(a){f.log("update end");var b=a.target.type;if(u){if(!z||"open"!==z.readyState)return;if(!D.audio.length&&!D.video.length){z.endOfStream();return}}if(0!=D[b].length&&(a=J[b],!a.updating)){b=D[b].shift();
try{a.appendBuffer(b)}catch(C){f.log(C)}}}function E(a){f.log("source buffer error")}function G(a){f.log("media source ended")}function F(a){f.log("media source close")}function k(a){f.log("media source error")}var n=f.extend(this,new a.eventdispatcher("renders.def")),t,A,r,y,w,z,J,D,u=!1;n.setup=function(){n.dispatchEvent(a.PLAYEASE_READY,{id:n.config.id})};n.play=function(a){a&&(l.url=a);if(a||t.src!=l.url)D.audio=[],D.video=[],A.abort(),r.reset(),y.reset(),t.pause(),t.src=URL.createObjectURL(z),
t.load();t.play()};n.pause=function(){t.pause()};n.seek=function(a){};n.stop=function(){D.audio=[];D.video=[];A.abort();t.pause();t.src=null};n.volume=function(a){};n.mute=function(a){};n.fullscreen=function(a){};n.appendInitSegment=function(b,c){var d=b+'/mp4; codecs="'+w[b+"Codec"]+'"';f.log("Mime type: "+d+".");MediaSource.isTypeSupported(d)?"closed"==z.readyState?n.dispatchEvent(a.PLAYEASE_RENDER_ERROR,{message:"MediaSource is closed while appending init segment."}):(d=J[b]=z.addSourceBuffer(d),
d.type=b,d.addEventListener("updateend",x),d.addEventListener("error",E),d.appendBuffer(c)):n.dispatchEvent(a.PLAYEASE_RENDER_ERROR,{message:"Mime type is not surpported: "+d+"."})};n.appendSegment=function(a,b){D[a].push(b);var c=J[a];c.updating||(b=D[a].shift(),c.appendBuffer(b))};n.element=function(){return t};n.resize=function(a,b){};n.destroy=function(){};n.name=h.FLV;n.config=f.extend({},{},l);J={audio:null,video:null};D={audio:[],video:[]};t=f.createElement("video");t.width=n.config.width;
t.height=n.config.height;t.controls=n.config.controls;t.autoplay=n.config.autoplay;t.poster=n.config.poster;n.config.autoplay||t.addEventListener("play",m);A=new f.loader(l.loader);A.addEventListener(a.PLAYEASE_CONTENT_LENGTH,function(a){f.log("onContenLength: "+a.length)});A.addEventListener(a.PLAYEASE_PROGRESS,function(a){r.parse(a.data)});A.addEventListener(a.PLAYEASE_COMPLETE,function(a){f.log("onLoaderComplete")});A.addEventListener(a.ERROR,function(a){f.log(a.message)});r=new q.flv;r.addEventListener(a.PLAYEASE_FLV_TAG,
function(a){switch(a.tag){case g.AUDIO:if(a.format&&a.format!=c.AAC){f.log("Unsupported audio format("+a.format+").");break}r.parseAACAudioPacket(a.data,a.offset,a.size,a.timestamp,a.rate,a.samplesize,a.sampletype);break;case g.VIDEO:if(a.codec&&a.codec!=e.AVC){f.log("Unsupported video codec("+a.codec+").");break}r.parseAVCVideoPacket(a.data,a.offset,a.size,a.timestamp,a.frametype);break;case g.SCRIPT:a=b.parse(a.data,a.offset,a.size);f.log(a.key+": "+JSON.stringify(a.value));"onMetaData"==a.key&&
r.setMetaData(a.value);break;default:f.log("Skipping unknown tag type "+a.tag)}});r.addEventListener(a.PLAYEASE_MEDIA_INFO,function(a){w=a.info});r.addEventListener(a.PLAYEASE_AVC_CONFIG_RECORD,function(a){y.setVideoMeta(a.data);y.getInitSegment(a.data)});r.addEventListener(a.PLAYEASE_AVC_SAMPLE,function(a){y.getVideoSegment(a.data)});r.addEventListener(a.PLAYEASE_AAC_SPECIFIC_CONFIG,function(a){y.setAudioMeta(a.data);y.getInitSegment(a.data)});r.addEventListener(a.PLAYEASE_AAC_SAMPLE,function(a){y.getAudioSegment(a.data)});
r.addEventListener(a.PLAYEASE_END_OF_STREAM,function(a){u=!0});r.addEventListener(a.ERROR,function(a){f.log(a.message)});y=new q.mp4;y.addEventListener(a.PLAYEASE_MP4_INIT_SEGMENT,function(a){n.appendInitSegment(a.tp,a.data)});y.addEventListener(a.PLAYEASE_MP4_SEGMENT,function(a){n.appendSegment(a.tp,a.data)});y.addEventListener(a.ERROR,function(a){f.log(a.message)});window.MediaSource=window.MediaSource||window.WebKitMediaSource;z=new MediaSource;z.addEventListener("sourceopen",v);z.addEventListener("sourceended",
G);z.addEventListener("sourceclose",F);z.addEventListener("error",k);z.addEventListener("webkitsourceopen",v);z.addEventListener("webkitsourceended",G);z.addEventListener("webkitsourceclose",F);z.addEventListener("webkiterror",k)}})(playease);
(function(d){var f=d.utils,a=d.events,q=d.core;q.entity=function(d){var b=f.extend(this,new a.eventdispatcher("core.entity")),g,c,e;b.setup=function(){setTimeout(function(){c.setup()},0)};b.destroy=function(){e&&e.stop();c&&c.destroy();g&&g.destroy()};b.id=d.id;b.model=g=new q.model(d);b.view=c=new q.view(b,g);b.controller=e=new q.controller(g,c);e.addGlobalListener(function(a){b.dispatchEvent(a.type,a)});b.play=e.play;b.pause=e.pause;b.seek=e.seek;b.stop=e.stop;b.volume=e.volume;b.mute=e.mute;b.fullscreen=
e.fullscreen;b.getState=g.getState;b.resize=c.resize}})(playease);
(function(d){var f=d.utils,a=d.events;d=d.core;var q=d.states;d.model=function(d){var b=f.extend(this,new a.eventdispatcher("core.model")),g=q.STOPPED,c;b.setState=function(c){c!==g&&(g=c,b.dispatchEvent(a.PLAYEASE_STATE,{state:c}))};b.getState=function(){return g};b.setProperty=function(d,g){1==c.hasOwnProperty(d)&&(c[d]=g,b.dispatchEvent(a.PLAYEASE_PROPERTY,{key:d,value:g}))};b.getProperty=function(a){return c[a]};b.getConfig=function(a){return b.config[a]||{}};b.destroy=function(){};b.config=f.extend({},
{},d);c={}}})(playease);
(function(d){var f=d.utils,a=d.events;d=d.core;var q=d.renders,h=d.skins;d.view=function(b,d){function c(){var c=f.extend({},d.getConfig("render"),{id:b.id,url:d.config.url,width:d.config.width,height:d.config.height,controls:d.config.controls,autoplay:d.config.autoplay,poster:d.config.poster,loader:{mode:d.config.cors}});try{n=v.render=new q[c.name](v,c),n.addEventListener(a.PLAYEASE_READY,B),n.addEventListener(a.PLAYEASE_VIEW_PLAY,B),n.addEventListener(a.PLAYEASE_RENDER_ERROR,l)}catch(A){f.log("Failed to init render "+
c.name+"!")}n&&E.appendChild(n.element())}function e(){var a=f.extend({},d.getConfig("skin"),{id:b.id,width:d.config.width,height:d.config.height});try{new h[a.name](a)}catch(A){f.log("Failed to init skin "+a.name+"!")}}function g(a){if(a.ctrlKey||a.metaKey)return!0;if(/13|32/.test(a.keyCode))return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}function l(a){B(a)}function B(a){v.dispatchEvent(a.type,a)}var v=f.extend(this,new a.eventdispatcher("core.view")),x,E,G,F,k,n;v.setup=function(){if(n){n.setup();
try{x.addEventListener("keydown",g)}catch(t){x.attachEvent("onkeydown",g)}}else v.dispatchEvent(a.PLAYEASE_SETUP_ERROR,{message:"Render not available!",name:d.config.render.name})};v.display=function(a,b){};v.resize=function(a,b){n&&n.resize(a,b)};v.destroy=function(){if(x)try{x.removeEventListener("keydown",g)}catch(t){x.detachEvent("onkeydown",g)}n&&n.destroy()};(function(){x=f.createElement("div","pla-wrapper pla-skin-"+d.config.skin.name);x.id=b.id;x.tabIndex=0;E=f.createElement("div","pla-render");
G=f.createElement("div","pla-poster");F=f.createElement("div","pla-controls");k=f.createElement("div","pla-contextmenu");x.appendChild(E);x.appendChild(G);x.appendChild(F);x.appendChild(k);c();e();var a=document.getElementById(b.id);a.parentNode.replaceChild(x,a);window.onresize=function(){"function"==f.typeOf(d.config.onresize)&&d.config.onresize.call(null)}})()}})(playease);
(function(d){var f=d.utils,a=d.events;d=d.core;var q=d.states;d.controller=function(d,b){function g(a){c.dispatchEvent(a.type,a)}var c=f.extend(this,new a.eventdispatcher("core.controller")),e=!1;d.addEventListener(a.PLAYEASE_STATE,function(b){switch(b.state){case q.BUFFERING:c.dispatchEvent(a.PLAYEASE_BUFFER);break;case q.PLAYING:c.dispatchEvent(a.PLAYEASE_PLAY);break;case q.PAUSED:c.dispatchEvent(a.PLAYEASE_PAUSE);break;case q.SEEKING:c.dispatchEvent(a.PLAYEASE_SEEK);break;case q.STOPPED:c.dispatchEvent(a.PLAYEASE_STOP);
break;case q.ERROR:break;default:c.dispatchEvent(a.ERROR,{message:"Unknown model state!",state:b.state})}});b.addEventListener(a.PLAYEASE_READY,function(a){e||(f.log("Player ready!"),e=!0,g(a),d.config.autoplay&&c.play(),window.onbeforeunload=function(a){})});b.addEventListener(a.PLAYEASE_SETUP_ERROR,function(a){d.setState(q.ERROR);g(a)});b.addEventListener(a.PLAYEASE_VIEW_PLAY,function(a){var b=d.getState();if(b==q.PAUSED||b==q.STOPPED||b==q.ERROR)c.play(),g(a)});b.addEventListener(a.PLAYEASE_VIEW_PAUSE,
function(a){var b=d.getState();if(b==q.BUFFERING||b==q.PLAYING||b==q.ERROR)c.pause(),g(a)});b.addEventListener(a.PLAYEASE_VIEW_SEEK,function(a){d.getState()!=q.SEEKING&&(c.seek(a.time),g(a))});b.addEventListener(a.PLAYEASE_VIEW_STOP,function(a){c.stop();g(a)});b.addEventListener(a.PLAYEASE_VIEW_VOLUNE,function(a){c.volume(a.vol);g(a)});b.addEventListener(a.PLAYEASE_VIEW_FULLSCREEN,function(a){c.fullscreen(a.esc);g(a)});b.addEventListener(a.PLAYEASE_RENDER_ERROR,function(a){d.setState(q.ERROR);g(a)});
c.play=b.render.play;c.pause=b.render.pause;c.seek=b.render.seek;c.stop=b.render.stop;c.volume=b.render.volume;c.mute=b.render.mute;c.fullscreen=b.render.fullscreen}})(playease);
(function(d){var f=d.utils,a=d.events,q=d.embed=function(h){function b(b){switch(b.type){case a.ERROR:case a.PLAYEASE_SETUP_ERROR:case a.PLAYEASE_RENDER_ERROR:case a.PLAYEASE_ERROR:g.errorScreen(b.message);g.dispatchEvent(a.ERROR,b);break;default:g.dispatchEvent(b.type,b)}}var g=f.extend(this,new a.eventdispatcher("embed")),c={},e=!1,m=null;g.embed=function(){try{c=new q.config(h.config),m=new q.embedder(h,c)}catch(l){f.log("Failed to init embedder!");g.dispatchEvent(a.PLAYEASE_SETUP_ERROR,{message:"Failed to init embedder!",
render:c.render.name});return}m.addGlobalListener(b);m.embed()};g.errorScreen=function(a){e||(e=!0,d.api.displayError(a,c))};(function(){f.foreach(h.config.events,function(a,b){a=h[a];"function"===f.typeOf(a)&&a.call(h,b)})})()}})(playease);
(function(d){var f=d.utils,a=d.embed,q=d.core.renders.modes,h=d.core.skins.modes;a.config=function(a){return f.extend({},{url:"http://"+window.location.host+"/vod/sample.mp4",width:640,height:360,cors:"no-cors",bufferTime:.1,controls:!0,autoplay:!0,poster:null,render:{name:q.DEFAULT},skin:{name:h.DEFAULT}},a)};a.config.addConfig=function(a,d){return f.extend(a,d)}})(playease);
(function(d){var f=d.utils,a=d.events,q=d.core;d.embed.embedder=function(d,b){function g(a){c.dispatchEvent(a.type,a)}var c=f.extend(this,new a.eventdispatcher("embed.embedder"));c.embed=function(){var a=new q.entity(b);a.addGlobalListener(g);a.setup();d.setEntity(a,b.render.name)}}})(playease);